<!DOCTYPE html>

<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãŠã†ã¡ã”ã¯ã‚“å¸³ ğŸš</title>
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&family=Kosugi+Maru&display=swap" rel="stylesheet">
<style>
  :root {
    --cream: #FDF6EC;
    --warm-white: #FFFBF4;
    --orange: #E8834A;
    --orange-light: #F5A673;
    --orange-pale: #FDE8D8;
    --green: #6BAE72;
    --green-light: #A8D5AC;
    --green-pale: #E8F5E9;
    --brown: #8B5E3C;
    --brown-light: #C49A6C;
    --text: #3D2B1F;
    --text-light: #7A5C45;
    --shadow: rgba(139,94,60,0.12);
    --baby-pink: #F9D5D3;
    --baby-blue: #D3E8F9;
    --toddler-yellow: #FDF0C2;
    --premium: #7C4DFF;
    --premium-pale: #EDE7FF;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family:'Zen Maru Gothic',sans-serif; background:var(--cream); color:var(--text); min-height:100vh; }

/* ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== */
header {
background: linear-gradient(135deg,#E8834A 0%,#C96A2E 100%);
padding: 20px 24px 60px;
position:relative; overflow:hidden;
}
header::before {
content:â€™â€™; position:absolute; bottom:-30px; left:0; right:0;
height:60px; background:var(â€“cream);
border-radius:50% 50% 0 0/100% 100% 0 0;
}
.header-inner { max-width:600px; margin:0 auto; text-align:center; position:relative; z-index:1; }
.logo { font-size:28px; font-weight:700; color:white; text-shadow:0 2px 8px rgba(0,0,0,.15); letter-spacing:.05em; }
.logo span { font-size:32px; }
.tagline { color:rgba(255,255,255,.9); font-size:13px; margin-top:4px; font-family:â€˜Kosugi Maruâ€™,sans-serif; }

/* ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒãƒƒã‚¸ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼å³ä¸Šï¼‰ */
.premium-header-btn {
position:absolute; top:16px; right:16px;
background:rgba(255,255,255,.2); border:1.5px solid rgba(255,255,255,.6);
color:white; font-size:11px; padding:5px 10px; border-radius:20px;
font-family:â€˜Kosugi Maruâ€™,sans-serif; cursor:pointer;
transition:background .2s;
}
.premium-header-btn:hover { background:rgba(255,255,255,.35); }
.premium-header-btn.active { background:linear-gradient(135deg,#FFD700,#FFA000); border-color:#FFA000; color:#3D2B1F; }

/* ===== ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ ===== */
main { max-width:600px; margin:0 auto; padding:0 16px 80px; }

/* ===== åºƒå‘Šæ ï¼ˆä¸Šéƒ¨ï¼‰ ===== */
.ad-banner {
margin-top:14px;
background:white;
border:1.5px dashed #D4B896;
border-radius:14px;
padding:12px;
text-align:center;
font-family:â€˜Kosugi Maruâ€™,sans-serif;
font-size:11px;
color:var(â€“text-light);
position:relative;
overflow:hidden;
}
.ad-banner.premium-hidden { display:none; }
.ad-label {
position:absolute; top:4px; left:8px;
font-size:9px; color:#B0A090; letter-spacing:.05em;
}
.ad-content {
display:flex; align-items:center; justify-content:center; gap:10px;
padding-top:8px;
}
.ad-content img { width:40px; height:40px; border-radius:8px; object-fit:cover; }
.ad-text { text-align:left; }
.ad-text strong { display:block; font-size:13px; color:var(â€“brown); }
.ad-btn {
background:var(â€“orange); color:white; border:none;
border-radius:8px; padding:5px 10px; font-size:11px; cursor:pointer;
font-family:â€˜Kosugi Maruâ€™,sans-serif;
}

/* ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒãƒŠãƒ¼ ===== */
.premium-banner {
margin-top:10px;
background:linear-gradient(135deg,#7C4DFF,#512DA8);
border-radius:14px;
padding:14px 16px;
display:flex; align-items:center; justify-content:space-between; gap:10px;
}
.premium-banner.hidden { display:none; }
.premium-banner-text { color:white; font-size:12px; font-family:â€˜Kosugi Maruâ€™,sans-serif; line-height:1.6; }
.premium-banner-text strong { font-size:14px; display:block; }
.premium-btn {
background:white; color:var(â€“premium);
border:none; border-radius:10px; padding:8px 14px;
font-size:12px; font-weight:700; cursor:pointer;
font-family:â€˜Zen Maru Gothicâ€™,sans-serif; white-space:nowrap;
transition:transform .15s;
}
.premium-btn:hover { transform:scale(1.04); }

/* ===== å¹´é½¢ã‚¿ãƒ– ===== */
.age-tabs {
display:flex; gap:8px; margin-top:16px;
background:white; border-radius:20px; padding:6px;
box-shadow:0 4px 20px var(â€“shadow);
}
.age-tab {
flex:1; padding:10px 4px; border:none; border-radius:14px;
font-family:â€˜Zen Maru Gothicâ€™,sans-serif; font-size:13px; font-weight:500;
cursor:pointer; transition:all .25s; background:transparent; color:var(â€“text-light);
display:flex; flex-direction:column; align-items:center; gap:2px;
}
.age-tab .tab-icon { font-size:20px; }
.age-tab.active[data-age=â€œadultâ€]   { background:var(â€“orange); color:white; box-shadow:0 4px 12px rgba(232,131,74,.4); }
.age-tab.active[data-age=â€œtoddlerâ€] { background:#E6B830; color:white; box-shadow:0 4px 12px rgba(230,184,48,.4); }
.age-tab.active[data-age=â€œbabyâ€]    { background:#E87B8A; color:white; box-shadow:0 4px 12px rgba(232,123,138,.4); }

/* ===== æœˆé½¢ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ï¼ˆé›¢ä¹³é£Ÿã®ã¿ï¼‰ ===== */
.baby-month-selector {
margin-top:10px; display:none; animation:fadeIn .3s;
}
.baby-month-selector.show { display:block; }
.section-label { font-size:12px; color:var(â€“text-light); font-family:â€˜Kosugi Maruâ€™,sans-serif; margin-bottom:6px; padding-left:4px; }
.month-tabs { display:flex; gap:6px; flex-wrap:wrap; }
.month-tab {
padding:7px 14px; border:2px solid var(â€“baby-pink); border-radius:20px;
background:white; font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:12px;
cursor:pointer; transition:all .2s; color:#8B3A47;
}
.month-tab.active { background:#E87B8A; border-color:#E87B8A; color:white; }

/* å¹´é½¢ãƒ’ãƒ³ãƒˆ */
.age-hint {
padding:10px 14px; border-radius:12px; font-size:12px; margin-top:10px;
font-family:â€˜Kosugi Maruâ€™,sans-serif; line-height:1.6; animation:fadeIn .3s;
}
.age-hint[data-for=â€œadultâ€]   { background:var(â€“orange-pale); color:var(â€“brown); }
.age-hint[data-for=â€œtoddlerâ€] { background:var(â€“toddler-yellow); color:#7A6020; }
.age-hint[data-for=â€œbabyâ€]    { background:var(â€“baby-pink); color:#8B3A47; }

/* ===== ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ãƒ– ===== */
.genre-section { margin-top:18px; }
.genre-tabs { display:flex; gap:6px; flex-wrap:wrap; }
.genre-tab {
padding:8px 16px; border:2px solid var(â€“orange-pale); border-radius:20px;
background:white; font-family:â€˜Zen Maru Gothicâ€™,sans-serif; font-size:13px;
cursor:pointer; transition:all .2s; color:var(â€“text-light);
}
.genre-tab.active { background:var(â€“orange); border-color:var(â€“orange); color:white; }
.genre-tab:hover:not(.active) { border-color:var(â€“orange-light); color:var(â€“orange); }

/* ===== ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ===== */
.allergy-section { margin-top:18px; }
.allergy-toggle {
display:flex; align-items:center; gap:8px; cursor:pointer;
font-size:13px; color:var(â€“text-light); font-family:â€˜Kosugi Maruâ€™,sans-serif;
user-select:none;
}
.allergy-toggle-icon { transition:transform .2s; }
.allergy-toggle-icon.open { transform:rotate(90deg); }
.allergy-tags {
display:flex; flex-wrap:wrap; gap:6px; margin-top:10px;
display:none;
}
.allergy-tags.show { display:flex; animation:fadeIn .25s; }
.allergy-chip {
padding:6px 12px; border:2px solid #FFCDD2; border-radius:20px;
background:white; font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:12px;
cursor:pointer; transition:all .2s; color:#B71C1C;
display:flex; align-items:center; gap:4px;
}
.allergy-chip.selected { background:#FFCDD2; border-color:#E57373; }

/* ===== é£Ÿæå…¥åŠ› ===== */
.input-section {
margin-top:18px; background:white; border-radius:20px;
padding:20px; box-shadow:0 4px 20px var(â€“shadow);
}
.input-title { font-size:15px; font-weight:700; color:var(â€“brown); margin-bottom:12px; display:flex; align-items:center; gap:6px; }
.ingredient-input-row { display:flex; gap:8px; }
.ingredient-input {
flex:1; padding:12px 16px; border:2px solid var(â€“orange-pale);
border-radius:14px; font-family:â€˜Zen Maru Gothicâ€™,sans-serif; font-size:15px;
outline:none; transition:border-color .2s; background:var(â€“warm-white); color:var(â€“text);
}
.ingredient-input:focus { border-color:var(â€“orange); }
.ingredient-input::placeholder { color:#C4A882; font-size:13px; }
.add-btn {
width:46px; height:46px; border-radius:14px; border:none;
background:var(â€“orange); color:white; font-size:24px; cursor:pointer;
transition:transform .15s,box-shadow .15s;
display:flex; align-items:center; justify-content:center; flex-shrink:0;
}
.add-btn:hover { transform:scale(1.05); box-shadow:0 4px 12px rgba(232,131,74,.4); }
.add-btn:active { transform:scale(.97); }
.ingredient-tags { display:flex; flex-wrap:wrap; gap:6px; margin-top:12px; }
.ingredient-tag {
display:flex; align-items:center; gap:4px;
background:var(â€“orange-pale); color:var(â€“brown);
padding:5px 10px 5px 12px; border-radius:20px; font-size:13px; animation:popIn .2s;
}
.tag-remove {
width:18px; height:18px; border-radius:50%; border:none;
background:var(â€“brown-light); color:white; font-size:12px; cursor:pointer;
display:flex; align-items:center; justify-content:center; padding:0;
}

/* æ¤œç´¢ãƒœã‚¿ãƒ³ */
.search-btn {
width:100%; margin-top:16px; padding:16px; border:none; border-radius:16px;
background:linear-gradient(135deg,var(â€“orange) 0%,#C96A2E 100%);
color:white; font-family:â€˜Zen Maru Gothicâ€™,sans-serif; font-size:16px; font-weight:700;
cursor:pointer; transition:transform .15s,box-shadow .2s;
box-shadow:0 6px 20px rgba(232,131,74,.4); letter-spacing:.05em;
}
.search-btn:hover { transform:translateY(-1px); box-shadow:0 8px 24px rgba(232,131,74,.5); }
.search-btn:active { transform:translateY(1px); }
.search-btn:disabled { opacity:.6; cursor:not-allowed; transform:none; }

/* æ¤œç´¢å›æ•°è¡¨ç¤ºï¼ˆãƒ•ãƒªãƒ¼ãƒ—ãƒ©ãƒ³ï¼‰ */
.search-counter {
text-align:center; font-size:11px; color:var(â€“text-light);
font-family:â€˜Kosugi Maruâ€™,sans-serif; margin-top:8px;
}
.search-counter.warn { color:#E57373; }
.search-counter.premium-hidden { display:none; }

/* ===== ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° ===== */
.loading { text-align:center; padding:40px 20px; display:none; }
.loading-dots { display:flex; justify-content:center; gap:8px; margin-bottom:12px; }
.dot { width:12px; height:12px; border-radius:50%; background:var(â€“orange); animation:bounce 1.2s infinite; }
.dot:nth-child(2) { animation-delay:.2s; background:#E6B830; }
.dot:nth-child(3) { animation-delay:.4s; background:#E87B8A; }
.loading-text { font-family:â€˜Kosugi Maruâ€™,sans-serif; color:var(â€“text-light); font-size:14px; }

/* ã‚¨ãƒ©ãƒ¼ */
.error-msg { text-align:center; padding:30px; color:#E87B8A; font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:14px; display:none; }

/* ===== çµæœã‚¨ãƒªã‚¢ ===== */
.results-section { margin-top:20px; display:none; }
.results-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
.results-title { font-size:16px; font-weight:700; color:var(â€“brown); display:flex; align-items:center; gap:6px; }
.fav-tab-btn {
font-size:12px; padding:5px 12px; border:2px solid var(â€“orange-pale);
border-radius:14px; background:white; cursor:pointer; color:var(â€“orange);
font-family:â€˜Kosugi Maruâ€™,sans-serif; transition:all .2s;
}
.fav-tab-btn.active { background:var(â€“orange); color:white; border-color:var(â€“orange); }

/* ===== ãƒ¬ã‚·ãƒ”ã‚«ãƒ¼ãƒ‰ ===== */
.recipe-card {
background:white; border-radius:20px; padding:20px; margin-bottom:14px;
box-shadow:0 4px 20px var(â€“shadow); animation:fadeUp .4s ease;
border-left:4px solid var(â€“orange); position:relative;
transition:transform .2s,box-shadow .2s;
}
.recipe-card:hover { transform:translateY(-2px); box-shadow:0 8px 28px var(â€“shadow); }
.recipe-card[data-age=â€œtoddlerâ€] { border-left-color:#E6B830; }
.recipe-card[data-age=â€œbabyâ€]    { border-left-color:#E87B8A; }

.recipe-header { display:flex; justify-content:space-between; align-items:flex-start; gap:12px; }
.recipe-name { font-size:17px; font-weight:700; color:var(â€“text); line-height:1.4; cursor:pointer; }
.recipe-badges { display:flex; gap:4px; flex-shrink:0; flex-wrap:wrap; justify-content:flex-end; align-items:center; }
.badge { font-size:11px; padding:3px 8px; border-radius:10px; font-family:â€˜Kosugi Maruâ€™,sans-serif; white-space:nowrap; }
.badge-time   { background:var(â€“green-pale); color:var(â€“green); }
.badge-genre  { background:var(â€“orange-pale); color:var(â€“brown); }

/* ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ */
.fav-btn {
position:absolute; top:16px; right:16px;
background:none; border:none; font-size:22px; cursor:pointer;
transition:transform .2s; line-height:1;
}
.fav-btn:hover { transform:scale(1.2); }

.recipe-desc { font-size:13px; color:var(â€“text-light); margin-top:10px; line-height:1.7; font-family:â€˜Kosugi Maruâ€™,sans-serif; padding-right:28px; }

/* å±•é–‹è©³ç´° */
.recipe-detail { display:none; margin-top:16px; padding-top:16px; border-top:1px dashed var(â€“orange-pale); }
.recipe-detail.open { display:block; animation:fadeIn .3s; }
.detail-section-title { font-size:13px; font-weight:700; color:var(â€“brown); margin-bottom:8px; display:flex; align-items:center; gap:4px; }
.ingredient-list, .step-list { list-style:none; font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:13px; color:var(â€“text-light); }
.ingredient-list li { padding:4px 0; border-bottom:1px solid var(â€“orange-pale); display:flex; justify-content:space-between; }
.ingredient-list li:last-child { border-bottom:none; }
.step-list { counter-reset:steps; }
.step-list li { counter-increment:steps; padding:8px 0 8px 32px; position:relative; border-bottom:1px solid var(â€“orange-pale); line-height:1.6; }
.step-list li:last-child { border-bottom:none; }
.step-list li::before {
content:counter(steps); position:absolute; left:0; top:8px;
width:22px; height:22px; background:var(â€“orange); color:white;
border-radius:50%; font-size:12px; display:flex; align-items:center; justify-content:center; font-weight:700;
}
.recipe-card[data-age=â€œtoddlerâ€] .step-list li::before { background:#E6B830; }
.recipe-card[data-age=â€œbabyâ€]    .step-list li::before { background:#E87B8A; }
.baby-note    { background:var(â€“baby-pink); border-radius:10px; padding:10px 12px; font-size:12px; color:#8B3A47; margin-top:10px; font-family:â€˜Kosugi Maruâ€™,sans-serif; line-height:1.6; }
.toddler-note { background:var(â€“toddler-yellow); border-radius:10px; padding:10px 12px; font-size:12px; color:#7A6020; margin-top:10px; font-family:â€˜Kosugi Maruâ€™,sans-serif; line-height:1.6; }
.external-link {
display:flex; align-items:center; justify-content:center; gap:6px;
margin-top:12px; padding:10px; background:var(â€“green-pale); border-radius:10px;
color:var(â€“green); font-size:13px; text-decoration:none;
font-family:â€˜Kosugi Maruâ€™,sans-serif; transition:background .2s;
}
.external-link:hover { background:var(â€“green-light); color:white; }

/* ===== ãŠæ°—ã«å…¥ã‚Šã‚¿ãƒ–ï¼ˆç©ºã®å ´åˆï¼‰ ===== */
.empty-fav { text-align:center; padding:40px 20px; color:var(â€“text-light); font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:14px; line-height:2; }

/* ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ« ===== */
.modal-overlay {
position:fixed; inset:0; background:rgba(0,0,0,.5);
display:flex; align-items:center; justify-content:center;
z-index:1000; display:none; padding:20px;
}
.modal-overlay.show { display:flex; animation:fadeIn .2s; }
.modal {
background:white; border-radius:24px; padding:28px 24px;
max-width:400px; width:100%; text-align:center;
animation:fadeUp .3s;
}
.modal-emoji { font-size:48px; }
.modal-title { font-size:20px; font-weight:700; color:var(â€“premium); margin-top:8px; }
.modal-subtitle { font-size:13px; color:var(â€“text-light); font-family:â€˜Kosugi Maruâ€™,sans-serif; margin-top:6px; line-height:1.7; }
.modal-features { text-align:left; background:var(â€“premium-pale); border-radius:14px; padding:16px; margin:16px 0; }
.modal-feature { font-size:13px; font-family:â€˜Kosugi Maruâ€™,sans-serif; padding:4px 0; color:var(â€“text); }
.modal-price { font-size:28px; font-weight:700; color:var(â€“premium); margin:12px 0 4px; }
.modal-price span { font-size:14px; color:var(â€“text-light); }
.modal-cta {
width:100%; padding:14px; border:none; border-radius:14px;
background:linear-gradient(135deg,#7C4DFF,#512DA8); color:white;
font-size:16px; font-weight:700; font-family:â€˜Zen Maru Gothicâ€™,sans-serif;
cursor:pointer; margin-top:8px; transition:transform .15s;
}
.modal-cta:hover { transform:translateY(-1px); }
.modal-close {
background:none; border:none; color:var(â€“text-light);
font-size:13px; font-family:â€˜Kosugi Maruâ€™,sans-serif; cursor:pointer;
margin-top:12px; display:block; width:100%;
}

/* åºƒå‘Šï¼ˆä¸­é–“ï¼‰ */
.ad-mid {
background:white; border:1.5px dashed #D4B896; border-radius:14px;
padding:14px; margin:14px 0; text-align:center;
font-family:â€˜Kosugi Maruâ€™,sans-serif; font-size:12px; color:var(â€“text-light);
position:relative;
}
.ad-mid.premium-hidden { display:none; }
.ad-mid-label { font-size:9px; color:#B0A090; margin-bottom:4px; }
.ad-mid-content { font-size:13px; color:var(â€“brown); font-weight:500; }

/* ===== ãƒ•ãƒƒã‚¿ãƒ¼ ===== */
.footer-note { text-align:center; padding:20px; font-size:11px; color:var(â€“text-light); font-family:â€˜Kosugi Maruâ€™,sans-serif; line-height:1.8; }

/* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
@keyframes bounce { 0%,80%,100%{transform:scale(.7);opacity:.5} 40%{transform:scale(1);opacity:1} }
@keyframes fadeIn { from{opacity:0} to{opacity:1} }
@keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }
@keyframes popIn  { from{opacity:0;transform:scale(.7)} to{opacity:1;transform:scale(1)} }

.ai-badge {
display:inline-flex; align-items:center; gap:4px;
background:linear-gradient(135deg,#667eea,#764ba2); color:white;
font-size:10px; padding:2px 8px; border-radius:10px; margin-left:6px;
font-family:â€˜Kosugi Maruâ€™,sans-serif;
}
</style>

</head>
<body>

<!-- ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== -->

<header>
  <div class="header-inner">
    <div class="logo"><span>ğŸ³</span> ãŠã†ã¡ã”ã¯ã‚“å¸³</div>
    <div class="tagline">å†·è”µåº«ã®é£Ÿæã‹ã‚‰ãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆï¼å­è‚²ã¦å®¶æ—ã®ãŸã‚ã®æ–™ç†ã‚µãƒãƒ¼ãƒˆ</div>
  </div>
  <button class="premium-header-btn" id="premiumHeaderBtn" onclick="openModal()">ğŸ‘‘ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ </button>
</header>

<main>

  <!-- ===== åºƒå‘ŠãƒãƒŠãƒ¼ï¼ˆä¸Šéƒ¨ï¼‰ ===== -->

  <div class="ad-banner" id="adBannerTop">
    <div class="ad-label">åºƒ å‘Š</div>
    <div class="ad-content">
      <div style="font-size:32px">ğŸ¥¦</div>
      <div class="ad-text">
        <strong>Oisixï¼ˆã‚ªã‚¤ã‚·ãƒƒã‚¯ã‚¹ï¼‰</strong>
        è¾²è–¬ãƒ»åŒ–å­¦è‚¥æ–™ä¸ä½¿ç”¨ã®å®‰å¿ƒé£Ÿæã‚’ãŠå±Šã‘
      </div>
      <button class="ad-btn" onclick="alert('â€» å®Ÿéš›ã®åºƒå‘Šã¯AdSenseã‚„ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆã«å·®ã—æ›¿ãˆã¾ã™')">è©³ã—ã</button>
    </div>
  </div>

  <!-- ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒãƒŠãƒ¼ ===== -->

  <div class="premium-banner" id="premiumBanner">
    <div class="premium-banner-text">
      <strong>ğŸ‘‘ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã§åºƒå‘Šãªã—</strong>
      æœˆé¡480å††ã§æ¤œç´¢ç„¡åˆ¶é™ãƒ»å…¨æ©Ÿèƒ½è§£æ”¾
    </div>
    <button class="premium-btn" onclick="openModal()">è©¦ã™</button>
  </div>

  <!-- ===== å¹´é½¢ã‚¿ãƒ– ===== -->

  <div class="age-tabs">
    <button class="age-tab active" data-age="adult"   onclick="selectAge('adult')">  <span class="tab-icon">ğŸ½ï¸</span>å¤§äººå‘ã‘</button>
    <button class="age-tab"        data-age="toddler" onclick="selectAge('toddler')"><span class="tab-icon">ğŸ‘§</span>å¹¼å…é£Ÿ</button>
    <button class="age-tab"        data-age="baby"    onclick="selectAge('baby')">   <span class="tab-icon">ğŸ‘¶</span>é›¢ä¹³é£Ÿ</button>
  </div>

  <!-- æœˆé½¢ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ -->

  <div class="baby-month-selector" id="babyMonthSelector">
    <div class="section-label" style="margin-top:12px">ğŸŒ™ æœˆé½¢ã‚’é¸ã‚“ã§ãã ã•ã„</div>
    <div class="month-tabs">
      <button class="month-tab active" data-month="5-6"   onclick="selectMonth('5-6')">  5ã€œ6ãƒ¶æœˆï¼ˆåˆæœŸï¼‰</button>
      <button class="month-tab"        data-month="7-8"   onclick="selectMonth('7-8')">  7ã€œ8ãƒ¶æœˆï¼ˆä¸­æœŸï¼‰</button>
      <button class="month-tab"        data-month="9-11"  onclick="selectMonth('9-11')"> 9ã€œ11ãƒ¶æœˆï¼ˆå¾ŒæœŸï¼‰</button>
      <button class="month-tab"        data-month="12-18" onclick="selectMonth('12-18')">12ã€œ18ãƒ¶æœˆï¼ˆå®Œäº†æœŸï¼‰</button>
    </div>
  </div>

  <div class="age-hint" id="ageHint" data-for="adult">
    ğŸ§‘â€ğŸ³ å¤§äººå‘ã‘ï¼šã—ã£ã‹ã‚Šå‘³ä»˜ã‘ã®ã”é£¯ã€‚è¾›ã¿ã‚„ãŠé…’ã®é¢¨å‘³ã‚‚OKãªãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¾ã™ã€‚
  </div>

  <!-- ===== ã‚¸ãƒ£ãƒ³ãƒ«ã‚¿ãƒ– ===== -->

  <div class="genre-section">
    <div class="section-label">ğŸ—¾ æ–™ç†ã‚¸ãƒ£ãƒ³ãƒ«</div>
    <div class="genre-tabs">
      <button class="genre-tab active" data-genre="all"      onclick="selectGenre('all')">ã™ã¹ã¦</button>
      <button class="genre-tab"        data-genre="japanese" onclick="selectGenre('japanese')">å’Œé£Ÿ ğŸ±</button>
      <button class="genre-tab"        data-genre="western"  onclick="selectGenre('western')">æ´‹é£Ÿ ğŸ</button>
      <button class="genre-tab"        data-genre="chinese"  onclick="selectGenre('chinese')">ä¸­è¯ ğŸ¥Ÿ</button>
      <button class="genre-tab"        data-genre="other"    onclick="selectGenre('other')">ãã®ä»– ğŸŒ</button>
    </div>
  </div>

  <!-- ===== ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ ===== -->

  <div class="allergy-section">
    <div class="section-label">
      <span class="allergy-toggle" onclick="toggleAllergy()">
        <span class="allergy-toggle-icon" id="allergyIcon">â–¶</span>
        âš ï¸ ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼é™¤å¤–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆä»»æ„ï¼‰
      </span>
    </div>
    <div class="allergy-tags" id="allergyTags">
      <button class="allergy-chip" onclick="toggleAllergen(this,'åµ')">ğŸ¥š åµ</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'ä¹³è£½å“')">ğŸ¥› ä¹³è£½å“</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'å°éº¦')">ğŸŒ¾ å°éº¦</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'ãã°')">ğŸœ ãã°</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'è½èŠ±ç”Ÿ')">ğŸ¥œ è½èŠ±ç”Ÿ</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'ãˆã³')">ğŸ¦ ãˆã³</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'ã‹ã«')">ğŸ¦€ ã‹ã«</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'å¤§è±†')">ğŸ«˜ å¤§è±†</button>
      <button class="allergy-chip" onclick="toggleAllergen(this,'é­šä»‹é¡')">ğŸŸ é­šä»‹é¡</button>
    </div>
  </div>

  <!-- ===== é£Ÿæå…¥åŠ› ===== -->

  <div class="input-section">
    <div class="input-title">ğŸ¥• ä»Šã‚ã‚‹é£Ÿæã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>
    <div class="ingredient-input-row">
      <input type="text" id="ingredientInput" class="ingredient-input"
        placeholder="ä¾‹ï¼šé¶ã‚‚ã‚‚è‚‰ã€ã˜ã‚ƒãŒã„ã‚‚ã€ç‰ã­ã..."
        onkeydown="handleKeydown(event)">
      <button class="add-btn" onclick="addIngredient()">ï¼‹</button>
    </div>
    <div class="ingredient-tags" id="ingredientTags"></div>
    <button class="search-btn" id="searchBtn" onclick="searchRecipes()">
      âœ¨ ãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ã†
    </button>
    <div class="search-counter" id="searchCounter">ä»Šæ—¥ã‚ã¨ <strong id="remainCount">3</strong> å›æ¤œç´¢ã§ãã¾ã™ï¼ˆç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼‰</div>
  </div>

  <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->

  <div class="loading" id="loading">
    <div class="loading-dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
    <div class="loading-text" id="loadingText">AIãŒãƒ¬ã‚·ãƒ”ã‚’è€ƒãˆã¦ã„ã¾ã™...ğŸ³</div>
  </div>
  <div class="error-msg" id="errorMsg">âš ï¸ ãƒ¬ã‚·ãƒ”ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</div>

  <!-- ===== çµæœ ===== -->

  <div class="results-section" id="resultsSection">
    <div class="results-header">
      <div class="results-title">ğŸ‰ ææ¡ˆãƒ¬ã‚·ãƒ” <span class="ai-badge">âœ¦ AIç”Ÿæˆ</span></div>
      <button class="fav-tab-btn" id="favTabBtn" onclick="toggleFavView()">â¤ï¸ ãŠæ°—ã«å…¥ã‚Š</button>
    </div>
    <div id="recipeList"></div>
  </div>

  <div class="footer-note">
    â€» ãƒ¬ã‚·ãƒ”ã¯AIãŒç”Ÿæˆã—ã¾ã™ã€‚ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã‚„æœˆé½¢ã®ç›®å®‰ã¯å¿…ãšã‹ã‹ã‚Šã¤ã‘ã®åŒ»å¸«ãƒ»æ „é¤Šå£«ã«ã‚‚ã”ç¢ºèªãã ã•ã„ã€‚<br>
    åºƒå‘Šåå…¥ã¯ã‚¢ãƒ—ãƒªã®é‹å–¶ãƒ»æ”¹å–„ã«ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
  </div>
</main>

<!-- ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ« ===== -->

<div class="modal-overlay" id="modalOverlay" onclick="closeModalOutside(event)">
  <div class="modal">
    <div class="modal-emoji">ğŸ‘‘</div>
    <div class="modal-title">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³</div>
    <div class="modal-subtitle">å­è‚²ã¦å®¶æ—ã®æ¯æ—¥ã®çŒ®ç«‹ã‚’ã‚‚ã£ã¨ãƒ©ã‚¯ã«</div>
    <div class="modal-features">
      <div class="modal-feature">âœ… æ¤œç´¢å›æ•° ç„¡åˆ¶é™</div>
      <div class="modal-feature">âœ… åºƒå‘Šãªã—ãƒ»ã™ã£ãã‚Šè¡¨ç¤º</div>
      <div class="modal-feature">âœ… ãŠæ°—ã«å…¥ã‚Š ç„¡åˆ¶é™ä¿å­˜</div>
      <div class="modal-feature">âœ… ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼é™¤å¤–ãƒ—ãƒ­è¨­å®š</div>
      <div class="modal-feature">âœ… é€±é–“çŒ®ç«‹ãƒ—ãƒ©ãƒ³è‡ªå‹•ç”Ÿæˆ</div>
      <div class="modal-feature">âœ… æœˆé½¢åˆ¥ãƒ»æ „é¤Šãƒãƒ©ãƒ³ã‚¹è¡¨ç¤º</div>
    </div>
    <div class="modal-price">Â¥480 <span>/ æœˆï¼ˆç¨è¾¼ï¼‰</span></div>
    <button class="modal-cta" onclick="activatePremium()">ğŸ‰ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’å§‹ã‚ã‚‹</button>
    <button class="modal-close" onclick="closeModal()">ä»Šã¯ã—ãªã„</button>
  </div>
</div>

<script>
  // ===== State =====
  let currentAge = 'adult';
  let currentGenre = 'all';
  let currentMonth = '5-6';
  let ingredients = [];
  let allergens = [];
  let isPremium = false;
  let searchCount = 0;
  const FREE_LIMIT = 3;
  let favorites = JSON.parse(localStorage.getItem('ouchi_favs') || '[]');
  let currentRecipes = [];
  let showingFavs = false;

  const ageHints = {
    adult:   'ğŸ§‘â€ğŸ³ å¤§äººå‘ã‘ï¼šã—ã£ã‹ã‚Šå‘³ä»˜ã‘ã®ã”é£¯ã€‚è¾›ã¿ã‚„ãŠé…’ã®é¢¨å‘³ã‚‚OKãªãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¾ã™ã€‚',
    toddler: 'ğŸ‘§ å¹¼å…é£Ÿï¼ˆ1ã€œ5æ­³ï¼‰ï¼šè–„å‘³ãƒ»ã‚„ã‚ã‚‰ã‹é£Ÿæ„ŸãŒåŸºæœ¬ã€‚é£Ÿã¹ã‚„ã™ã„ã‚µã‚¤ã‚ºã«æ•´ãˆãŸãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¾ã™ã€‚',
    baby:    'ğŸ‘¶ é›¢ä¹³é£Ÿï¼šé¸æŠã—ãŸæœˆé½¢ã«åˆã‚ã›ãŸå›ºã•ãƒ»é£Ÿæãƒ»èª¿ç†æ³•ã‚’è€ƒæ…®ã—ã¾ã™ã€‚ã”ä½¿ç”¨å‰ã«åŒ»å¸«ã«ã‚‚ã”ç›¸è«‡ãã ã•ã„ã€‚'
  };
  const genreNames   = { all:'ãªã‚“ã§ã‚‚', japanese:'å’Œé£Ÿ', western:'æ´‹é£Ÿ', chinese:'ä¸­è¯', other:'ãã®ä»–ï¼ˆã‚¨ã‚¹ãƒ‹ãƒƒã‚¯ãƒ»éŸ“å›½æ–™ç†ãªã©ï¼‰' };
  const ageNames     = { adult:'å¤§äººå‘ã‘', toddler:'å¹¼å…é£Ÿï¼ˆ1ã€œ5æ­³ï¼‰', baby:'é›¢ä¹³é£Ÿ' };
  const monthLabels  = { '5-6':'5ã€œ6ãƒ¶æœˆï¼ˆåˆæœŸï¼‰', '7-8':'7ã€œ8ãƒ¶æœˆï¼ˆä¸­æœŸï¼‰', '9-11':'9ã€œ11ãƒ¶æœˆï¼ˆå¾ŒæœŸï¼‰', '12-18':'12ã€œ18ãƒ¶æœˆï¼ˆå®Œäº†æœŸï¼‰' };

  // ===== å¹´é½¢ =====
  function selectAge(age) {
    currentAge = age;
    document.querySelectorAll('.age-tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`.age-tab[data-age="${age}"]`).classList.add('active');
    const hint = document.getElementById('ageHint');
    hint.textContent = ageHints[age];
    hint.setAttribute('data-for', age);
    const selector = document.getElementById('babyMonthSelector');
    selector.classList.toggle('show', age === 'baby');
    clearResults();
  }

  function selectMonth(m) {
    currentMonth = m;
    document.querySelectorAll('.month-tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`.month-tab[data-month="${m}"]`).classList.add('active');
    clearResults();
  }

  // ===== ã‚¸ãƒ£ãƒ³ãƒ« =====
  function selectGenre(genre) {
    currentGenre = genre;
    document.querySelectorAll('.genre-tab').forEach(t => t.classList.remove('active'));
    document.querySelector(`.genre-tab[data-genre="${genre}"]`).classList.add('active');
    clearResults();
  }

  // ===== ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ =====
  function toggleAllergy() {
    const tags = document.getElementById('allergyTags');
    const icon = document.getElementById('allergyIcon');
    tags.classList.toggle('show');
    icon.classList.toggle('open');
  }

  function toggleAllergen(el, name) {
    el.classList.toggle('selected');
    if (allergens.includes(name)) {
      allergens = allergens.filter(a => a !== name);
    } else {
      allergens.push(name);
    }
  }

  // ===== é£Ÿæå…¥åŠ› =====
  function handleKeydown(e) { if (e.key === 'Enter') addIngredient(); }

  function addIngredient() {
    const input = document.getElementById('ingredientInput');
    const val = input.value.trim();
    if (!val) return;
    const items = val.split(/[\sã€€,ï¼Œã€]+/).filter(v => v.length > 0);
    items.forEach(item => { if (!ingredients.includes(item)) ingredients.push(item); });
    input.value = '';
    renderTags();
    clearResults();
  }

  function removeIngredient(item) {
    ingredients = ingredients.filter(i => i !== item);
    renderTags();
  }

  function renderTags() {
    const container = document.getElementById('ingredientTags');
    container.innerHTML = ingredients.map(item => `
      <div class="ingredient-tag">${item}
        <button class="tag-remove" onclick="removeIngredient('${item}')">Ã—</button>
      </div>`).join('');
  }

  function clearResults() {
    document.getElementById('resultsSection').style.display = 'none';
    document.getElementById('errorMsg').style.display = 'none';
    showingFavs = false;
    const fb = document.getElementById('favTabBtn');
    fb.classList.remove('active');
    fb.textContent = 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Š';
  }

  // ===== æ¤œç´¢ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ =====
  function updateCounter() {
    const el = document.getElementById('searchCounter');
    const remain = document.getElementById('remainCount');
    if (isPremium) { el.classList.add('premium-hidden'); return; }
    el.classList.remove('premium-hidden');
    const left = FREE_LIMIT - searchCount;
    remain.textContent = left;
    el.className = 'search-counter' + (left <= 1 ? ' warn' : '');
  }

  // ===== æ¤œç´¢ =====
  async function searchRecipes() {
    if (ingredients.length === 0) { alert('é£Ÿæã‚’1ã¤ä»¥ä¸Šå…¥åŠ›ã—ã¦ãã ã•ã„ ğŸ¥•'); return; }
    if (!isPremium && searchCount >= FREE_LIMIT) { openModal(); return; }

    const btn = document.getElementById('searchBtn');
    const loading = document.getElementById('loading');
    btn.disabled = true;
    loading.style.display = 'block';
    document.getElementById('resultsSection').style.display = 'none';
    document.getElementById('errorMsg').style.display = 'none';
    showingFavs = false;

    const ageLabel   = ageNames[currentAge];
    const genreLabel = genreNames[currentGenre];
    const monthLabel = currentAge === 'baby' ? monthLabels[currentMonth] : '';
    const allergyStr = allergens.length > 0 ? `\né™¤å¤–ã‚¢ãƒ¬ãƒ«ã‚²ãƒ³ï¼š${allergens.join('ã€')}ï¼ˆã“ã‚Œã‚‰ã‚’å«ã‚€é£Ÿæãƒ»èª¿å‘³æ–™ã¯ä¸€åˆ‡ä½¿ã‚ãªã„ã§ãã ã•ã„ï¼‰` : '';

    const prompt = buildPrompt(ingredients, ageLabel, genreLabel, monthLabel, allergyStr);

    try {
      // â† APIã‚­ãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆ/api/recipeï¼‰ã«éš ã‚Œã¦ã„ã‚‹ã®ã§å®‰å…¨
      const response = await fetch("/api/recipe", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body: JSON.stringify({ prompt })
      });
      const data = await response.json();
      const text = data.content.map(c=>c.text||'').join('');
      const clean = text.replace(/```json|```/g,'').trim();
      const parsed = JSON.parse(clean);
      currentRecipes = parsed.recipes;
      searchCount++;
      updateCounter();
      renderRecipes(currentRecipes);
    } catch(e) {
      document.getElementById('errorMsg').style.display = 'block';
      console.error(e);
    } finally {
      btn.disabled = false;
      loading.style.display = 'none';
    }
  }

  function buildPrompt(items, ageLabel, genreLabel, monthLabel, allergyStr) {
    let p = `é£Ÿæï¼š${items.join('ã€')}\nã‚¸ãƒ£ãƒ³ãƒ«ï¼š${genreLabel}\nå¯¾è±¡ï¼š${ageLabel}`;
    if (monthLabel) p += `ï¼ˆ${monthLabel}ï¼‰`;
    p += allergyStr;
    p += `\nä¸Šè¨˜ã®æ¡ä»¶ã§3ã¤ã®ãƒ¬ã‚·ãƒ”ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚`;
    if (currentAge === 'baby') p += `\næœˆé½¢ã«åˆã‚ã›ãŸå›ºã•ãƒ»é£Ÿæã®å®‰å…¨æ€§ãƒ»èª¿ç†æ³•ã«å¿…ãšé…æ…®ã—ã€ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ãƒªã‚¹ã‚¯ã®ã‚ã‚‹é£Ÿæã«ã¯noteã§æ³¨æ„ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„ã€‚`;
    if (currentAge === 'toddler') p += `\nå¹¼å…é£Ÿã¯è–„å‘³ãƒ»ã‚„ã‚ã‚‰ã‹ãƒ»å°ã•ã‚ã‚µã‚¤ã‚ºã§ã€‚`;
    return p;
  }

  // ===== ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° =====
  function renderRecipes(recipes, isFav = false) {
    const list = document.getElementById('recipeList');
    const age  = currentAge;

    if (recipes.length === 0) {
      list.innerHTML = '<div class="empty-fav">â¤ï¸ ãŠæ°—ã«å…¥ã‚Šãƒ¬ã‚·ãƒ”ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“<br>ãƒ¬ã‚·ãƒ”ã‚«ãƒ¼ãƒ‰ã® â™¡ ã‚’æŠ¼ã—ã¦ä¿å­˜ã—ã¾ã—ã‚‡ã†</div>';
      document.getElementById('resultsSection').style.display = 'block';
      return;
    }

    // ä¸­é–“åºƒå‘Šï¼ˆãƒ•ãƒªãƒ¼ã®ã¿ã€çµæœãŒ2ä»¶ä»¥ä¸Šã®ã¨ãï¼‰
    const adMid = isPremium || recipes.length < 2 ? '' : `
      <div class="ad-mid" id="adMid">
        <div class="ad-mid-label">åºƒ å‘Š</div>
        <div class="ad-mid-content">ğŸ¼ ãƒ™ãƒ“ãƒ¼ãƒ•ãƒ¼ãƒ‰ãƒ»é›¢ä¹³é£Ÿã‚°ãƒƒã‚ºã¯ã‚³ãƒãƒ© â–¶ <span style="color:var(--orange);cursor:pointer" onclick="alert('â€» ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆãƒªãƒ³ã‚¯ã«å·®ã—æ›¿ãˆã¾ã™')">Amazon ã§æ¢ã™</span></div>
      </div>`;

    list.innerHTML = recipes.map((r, i) => {
      const isFaved = favorites.some(f => f.name === r.name);
      const noteHtml = r.note
        ? age === 'baby'    ? `<div class="baby-note">ğŸ‘¶ ${r.note}</div>`
        : age === 'toddler' ? `<div class="toddler-note">ğŸ‘§ ${r.note}</div>`
        : '' : '';
      const ingredientsHtml = (r.ingredients||[]).map(ing=>`<li><span>${ing.name}</span><span>${ing.amount}</span></li>`).join('');
      const stepsHtml = (r.steps||[]).map(s=>`<li>${s}</li>`).join('');
      const searchKw = encodeURIComponent(r.name);

      const card = `
        <div class="recipe-card" data-age="${isFav ? (r.age||age) : age}" data-idx="${i}">
          <button class="fav-btn" onclick="toggleFav(event,${i})" title="ãŠæ°—ã«å…¥ã‚Š">${isFaved?'â¤ï¸':'ğŸ¤'}</button>
          <div class="recipe-header">
            <div class="recipe-name" onclick="toggleDetail('detail-${i}')">${r.name}</div>
            <div class="recipe-badges">
              <span class="badge badge-time">â± ${r.time||'?åˆ†'}</span>
              <span class="badge badge-genre">${r.genre||''}</span>
            </div>
          </div>
          <div class="recipe-desc">${r.description||''}</div>
          <div class="recipe-detail" id="detail-${i}">
            <div class="detail-section-title">ğŸ¥¦ ææ–™</div>
            <ul class="ingredient-list">${ingredientsHtml}</ul>
            <div class="detail-section-title" style="margin-top:14px">ğŸ‘¨â€ğŸ³ ä½œã‚Šæ–¹</div>
            <ol class="step-list">${stepsHtml}</ol>
            ${noteHtml}
            <a class="external-link" href="https://cookpad.com/search/${searchKw}" target="_blank" rel="noopener" onclick="event.stopPropagation()">
              ğŸ”— ã‚¯ãƒƒã‚¯ãƒ‘ãƒƒãƒ‰ã§ã€Œ${r.name}ã€ã‚’æ¤œç´¢ã™ã‚‹
            </a>
          </div>
        </div>`;
      // ä¸­é–“åºƒå‘Šã¯2æšç›®ã®å¾Œã‚
      return i === 1 ? card + adMid : card;
    }).join('');

    document.getElementById('resultsSection').style.display = 'block';
  }

  function toggleDetail(id) {
    document.getElementById(id)?.classList.toggle('open');
  }

  // ===== ãŠæ°—ã«å…¥ã‚Š =====
  function toggleFav(event, idx) {
    event.stopPropagation();
    const recipes = showingFavs ? favorites : currentRecipes;
    const recipe  = recipes[idx];
    if (!recipe) return;
    const btn = document.querySelector(`.recipe-card[data-idx="${idx}"] .fav-btn`);
    const already = favorites.some(f => f.name === recipe.name);
    if (already) {
      favorites = favorites.filter(f => f.name !== recipe.name);
      if (btn) btn.textContent = 'ğŸ¤';
    } else {
      if (!isPremium && favorites.length >= 5) { openModal(); return; }
      recipe.age = currentAge;
      favorites.push(recipe);
      if (btn) btn.textContent = 'â¤ï¸';
    }
    localStorage.setItem('ouchi_favs', JSON.stringify(favorites));
  }

  function toggleFavView() {
    showingFavs = !showingFavs;
    const fb = document.getElementById('favTabBtn');
    fb.classList.toggle('active', showingFavs);
    fb.textContent = showingFavs ? 'ğŸ“‹ ææ¡ˆã«æˆ»ã‚‹' : 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Š';
    const title = document.querySelector('.results-title');
    if (showingFavs) {
      title.innerHTML = 'â¤ï¸ ãŠæ°—ã«å…¥ã‚Šãƒ¬ã‚·ãƒ”';
      renderRecipes(favorites, true);
    } else {
      title.innerHTML = 'ğŸ‰ ææ¡ˆãƒ¬ã‚·ãƒ” <span class="ai-badge">âœ¦ AIç”Ÿæˆ</span>';
      renderRecipes(currentRecipes);
    }
  }

  // ===== ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¢ãƒ¼ãƒ€ãƒ« =====
  function openModal()  { document.getElementById('modalOverlay').classList.add('show'); }
  function closeModal() { document.getElementById('modalOverlay').classList.remove('show'); }
  function closeModalOutside(e) { if (e.target === document.getElementById('modalOverlay')) closeModal(); }

  function activatePremium() {
    isPremium = true;
    closeModal();
    // UIæ›´æ–°
    document.getElementById('adBannerTop').classList.add('premium-hidden');
    document.getElementById('premiumBanner').classList.add('hidden');
    document.querySelectorAll('.ad-mid').forEach(el => el.classList.add('premium-hidden'));
    document.getElementById('premiumHeaderBtn').textContent = 'ğŸ‘‘ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡';
    document.getElementById('premiumHeaderBtn').classList.add('active');
    updateCounter();
    alert('ğŸ‰ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸï¼\nï¼ˆãƒ‡ãƒ¢ï¼‰å®Ÿéš›ã¯Stripeç­‰ã®æ±ºæ¸ˆé€£æºãŒå¿…è¦ã§ã™ã€‚');
  }

  // åˆæœŸåŒ–
  updateCounter();
</script>

</body>
</html>
